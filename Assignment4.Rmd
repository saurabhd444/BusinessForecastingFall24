---
title: "Assignment4"
author: "Saurabh Dudhane"
date: "2024-10-06"
output: html_document
---


```{r}
file <- ('C:/Users/saura/OneDrive/Desktop/Assignment/BF/Assignment4/Power Generation.csv')
#file has quarterly data on thermal power generation in KW (using Coal as the raw material) from 2001 to 2020(80 quarters)


#create a Dataframe
df<-data.frame(read.csv(file))
head(df)

#create a time series object for power generation
values<-c(df$Power.Generated.Using.Coal)
values
#create x axis quarters matching with data
ts <- ts(values, start = c(2001, 1), frequency = 4)
ts
#Plot Time series Graph
plot(ts, main = "Quarterly Power Generation from Coal", xlab = "Year", ylab = "Power in KW", col = "blue", lwd = 2)

#Time Series graph clearly shows there is a downward trend with the multiplicative seasonality in the data
#installing and using Forecast library
library(forecast)
naive_model <- naive(ts)
#Plotting the naive model
plot(naive_model)
#graph shows a flat blue line which explains the naive model which is nothing  but the last observed value of the Forecast
summary(naive_model)

#Plotting the mean forecast (Average model)
mean_forecast <- meanf(ts,5)
plot(mean_forecast)

# Seasonal Naive
snaive_forecast <- snaive(ts,5)

# Moving Averages

MA5_forecast <- ma(ts,order=5)
MA9_forecast <- ma(ts,order=9)


# plot all in a single chart

lines(naive_model$mean,col="red")
lines(snaive_forecast$mean,col="black")
lines(MA5_forecast,col="Pink")
lines(MA9_forecast,col="Blue")

# Calculate a simple moving average forecast with a window size of 3 using TTR 
library(zoo)
moving_avg <- rollmean(ts, k = 3, align = "right") 
plot(ts, main = "Time Series with Moving Average", col = "blue")
lines(moving_avg, col = "red")
legend("topright", legend = c("Original", "Moving Average"), col = c("blue", "red"), lty = 1)
#SMA smooths out short term fluctuation but highlights long term trends
forecast_sma<- forecast(moving_avg, h=12)
print(forecast_sma)

# All this above forecasting methods failed to capture trends and seasonality effectively hence using exponential smoothing with holtz winter

#Simple Exponential Smoothing  using ETS(Error trend seasonality)
forecast_result <- ets(ts)
plot(forecast_result)
attributes(forecast_result)
forecast_result$mse

#to optimize further now will implement HoltWinters on the dataset
# HoltWinters
HW_forecast <- HoltWinters(ts)
plot(HW_forecast)
print(HW_forecast)
summary(HW_forecast)
HW_forecast$SSE
forecasted_values_hw <- forecast(HW_forecast, h=12)

# Plot the forecast
plot(forecasted_values_hw)

summary(forecasted_values_hw)

# HoltWinters without trend and seasonality smoothing components
SSE_Simple <- HoltWinters(ts,beta=FALSE,gamma=FALSE)
attributes(SSE_Simple)
plot(SSE_Simple)
SSE_Simple$SSE
head(SSE_Simple$fitted)
```